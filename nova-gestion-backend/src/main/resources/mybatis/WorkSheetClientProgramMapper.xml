<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="nova.gestion.mappers.WorkSheetClientProgramMapper">

    <resultMap id="WorkSheetClientProgramMap" type="nova.gestion.model.WorkSheetClientProgram">
        <constructor>
            <arg name="idTaWorkSheetClientProgram" column="id_ta_work_sheet_client_program"/>
            <arg name="idWorkSheet" column="id_work_sheet"/>
        </constructor>
        <id column="idTaWorkSheetClientProgram" javaType="int" property="id_ta_work_sheet_client_program"/>
        <result column="id_work_sheet" javaType="int" property="idWorkSheet"/>

        <association column="id_program" property="program" javaType="nova.gestion.model.Program"
                     select="nova.gestion.mappers.ProgramMapper.getProgram"/>

        <association column="id_client" property="client" javaType="nova.gestion.model.Client"
                     select="nova.gestion.mappers.ClientMapper.getClient"/>

    </resultMap>

    <select id="getWorkSheetClientProgram" parameterType="int" resultMap="WorkSheetClientProgramMap">
        SELECT id_program, id_client
        FROM `nova_gestion`.`ta_work_sheet_client_program`
        WHERE `nova_gestion`.`ta_work_sheet_client_program`.id_ta_work_sheet_client_program = #{idTaWorkSheetClientProgram};
    </select>

    <insert id="insertProgramClient">
        INSERT INTO `nova_gestion`.`ta_work_sheet_client_program`(id_program, id_client)
        VALUES (#{program.idProgram}, #{client.idClient});
    </insert>

    <update id="updateProgramClient">
        UPDATE `nova_gestion`.`ta_work_sheet_client_program` SET
        <if test="program != null">id_program = #{program.idProgram},</if>
        <if test="client != null"> id_client = #{client.idClient}</if>
        WHERE id_program = #{program.idProgram} AND id_client = #{client.idClient} ;
    </update>

</mapper>