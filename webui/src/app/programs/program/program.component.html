<app-header title="{{pageTitle}}"></app-header>

<div class="page-area">

  <div class="form-area">
    <div [formGroup]="fg">
      <mat-form-field class="full-width-input">
        <input matInput placeholder="Nom" formControlName="name">
        <mat-error *ngIf="fcName.invalid">
          Un nom de programme est requis.
        </mat-error>
      </mat-form-field>

      <div class="input-btn">
        <mat-form-field class="input">
          <input matInput placeholder="Programme" formControlName="file">
        </mat-form-field>
        <app-button [label]="'Parcourir'" [style]="'primary'"></app-button>
      </div>

      <div class="input-btn">
        <mat-form-field class="full-width-input">
          <mat-label>Outil</mat-label>
          <mat-select formControlName="tool">
            <mat-option *ngFor="let tool of tools" [value]="tool">
              {{tool.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <!-- <app-button [label]="'Créer un outil'" [style]="'primary'"></app-button> -->
      </div>

      <div class="input-btn">
        <mat-form-field class="full-width-input">
          <mat-label>Tige de carbure</mat-label>
          <mat-select formControlName="blank">
            <mat-option *ngFor="let blank of blanks" [value]="blank">
              {{blank.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <!-- <app-button [label]="'Créer une tige'" [style]="'primary'"></app-button> -->
      </div>

      <mat-form-field class="full-width-input">
        <mat-label>Machine</mat-label>
        <mat-select formControlName="machine">
          <mat-option *ngFor="let machine of machines" [value]="machine">
            {{machine.name}}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="fcName.invalid">
            Une machine est requise.
          </mat-error>
      </mat-form-field>

    </div>

    <div class="btn-save" *ngIf="addingProgram">
      <app-button [label]="'Créer le programme'" [style]="'primary'" (clicked)="onCreate()"></app-button>
    </div>

    <div *ngIf="!addingProgram" [formGroup]="clientFg">
      <div class="input-btn">
        <mat-form-field class="input">
          <mat-label>Client</mat-label>
          <mat-select formControlName="client">
            <mat-option *ngFor="let client of clients" [value]="client">
              {{client.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <app-button class="btn" [label]="'Ajouter un client'" [style]="'primary'" (clicked)="addClient()"></app-button>
      </div>

      <div class="client-container">
        <div class="client-list" *ngFor="let client of program$ | async">
          <div>{{client.name}}</div>
          <mat-icon class="btn-delete" (click)="deleteClient(client.idClient)">delete</mat-icon>
        </div>
      </div>
    </div>

    <div class="btn-save" *ngIf="!addingProgram">
      <app-button [label]="'Retour'" [style]="'secondary'" (clicked)="onReturn()"></app-button>
      <app-button class="space-btn" [label]="'Sauvegarder'" [style]="'primary'" (clicked)="onSave()"></app-button>
    </div>

  </div>
</div>
